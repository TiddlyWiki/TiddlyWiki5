title: $:/snippets/peek-stylesheets

\parameters(filter:"[all[shadows+tiddlers]tag[$:/tags/Stylesheet]!is[draft]]")
\procedure expandable-stylesheets-list()
<ol>
<$list filter=<<filter>>>
<$vars state=<<qualify "$:/state/peek-stylesheets/open/">>>
<$set name="state" value={{{ [<state>addsuffix<currentTiddler>] }}}>
<li>
<%if [<state>get[text]match[yes]] %>
<$button set=<<state>> setTo="no" class="tc-btn-invisible">
{{$:/core/images/down-arrow}}
</$button>
<%else%>
<$button set=<<state>> setTo="yes" class="tc-btn-invisible">
{{$:/core/images/right-arrow}}
</$button>
<%endif%>
<$link>
<$view field="title"/>
</$link>
<$reveal type="match" state=<<state>> text="yes" tag="div">
<$set name="source" tiddler=<<currentTiddler>>>
<$wikify name="styles" text=<<source>>>
<$codeblock code=<<styles>> language="css"/>
</$wikify>
</$set>
</$reveal>
</li>
</$set>
</$vars>
</$list>
</ol>
\end

\procedure stylesheets-list()
<ol>
<$list filter=<<filter>>>
<li>
<$link>
<$view field="title"/>
</$link>
<$set name="source" tiddler=<<currentTiddler>>>
<$wikify name="styles" text=<<source>>>
<pre>
<code>
<$text text=<<styles>>/>
</code>
</pre>
</$wikify>
</$set>
</li>
</$list>
</ol>
\end
\whitespace trim

<$let modeState=<<qualify "$:/state/peek-stylesheets/mode/">>>

<%if [<modeState>get[text]match[expanded]] %>
<$button set=<<modeState>> setTo="restored" class="tc-btn-invisible">{{$:/core/images/chevron-down}} {{$:/language/ControlPanel/Stylesheets/Restore/Caption}}</$button>
<%else%>
<$button set=<<modeState>> setTo="expanded" class="tc-btn-invisible">{{$:/core/images/chevron-right}} {{$:/language/ControlPanel/Stylesheets/Expand/Caption}}</$button>
<%endif%>

<%if [<modeState>get[text]match[expanded]] %>
<<stylesheets-list>>
<%else%>
<<expandable-stylesheets-list>>
<%endif%>

</$let>
