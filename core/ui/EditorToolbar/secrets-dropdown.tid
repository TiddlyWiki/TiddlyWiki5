title: $:/core/ui/EditorToolbar/secrets-dropdown

\procedure secretPrefix() ¬ß[secret:
\procedure secretSuffix() ]

<$let state=<<secrets-state>>>

<%if [<state>match[unlocked]] %>

<div class="tc-editor-secrets-dropdown">
<$list filter=<<secrets-list>> variable="secretName">
<$button class="tc-btn-invisible tc-tiddlylink">

<$action-sendmessage
	$message="tm-edit-text-operation"
	$param="replace-selection"
	text={{{ [<secretName>addprefix<secretPrefix>addsuffix<secretSuffix>] }}}
/>

<$action-deletetiddler $tiddler=<<dropdown-state>>/>

{{$:/core/images/locked-padlock}} <$text text=<<secretName>>/>

</$button>
</$list>

<$list filter="[<secrets-list>count[]match[0]]">
<div class="tc-muted" style="padding: 0.5em;">
No secrets available. Add secrets using the Secrets Manager.
</div>
</$list>
</div>

<%elseif [<state>match[locked]] %>

<div class="tc-editor-secrets-locked" style="padding: 0.5em;">
<div class="tc-muted" style="margin-bottom: 0.5em;">
üîí Vault is locked
</div>
<$button class="tc-btn-invisible tc-tiddlylink">
<$action-unlock-secrets/>
<$action-deletetiddler $tiddler=<<dropdown-state>>/>
{{$:/core/images/unlocked-padlock}} Unlock Vault
</$button>
</div>

<% else %>

<div class="tc-muted" style="padding: 0.5em;">
‚ö†Ô∏è No encryption set up. Configure the Secrets Manager first.
</div>

<% endif %>

</$let>

<style>
.tc-editor-secrets-dropdown {
	min-width: 200px;
	max-height: 300px;
	overflow-y: auto;
}

.tc-editor-secrets-dropdown .tc-btn-invisible {
	display: block;
	width: 100%;
	text-align: left;
	padding: 4px 10px;
	border-radius: 3px;
}

.tc-editor-secrets-dropdown .tc-btn-invisible:hover {
	background-color: <<colour tiddler-selected-background>>;
	color: <<colour tiddler-selected-foreground>>;
}

.tc-editor-secrets-locked .tc-btn-invisible {
	display: block;
	width: 100%;
	text-align: left;
	padding: 4px 10px;
	border-radius: 3px;
}

.tc-editor-secrets-locked .tc-btn-invisible:hover {
	background-color: <<colour tiddler-selected-background>>;
	color: <<colour tiddler-selected-foreground>>;
}
</style>
