title: $:/plugins/tiddlywiki/markdown/md-to-tid/readme
type: text/vnd.tiddlywiki

! Markdown to Wikitext Conversion

This module provides functionality to convert Markdown text to TiddlyWiki wikitext format.

!! Usage

The conversion is available through multiple interfaces:

!!! JavaScript API

```javascript
var markdownText = "# Hello\n\nThis is **bold** text.";
var wikiAST = $tw.utils.markdownTextToWikiAST(markdownText);
var wikitext = $tw.utils.serializeWikitextParseTree(wikiAST);
// Result: "! Hello\n\nThis is ''bold'' text."
```

!!! Tiddler Toolbar Button

When viewing a markdown tiddler (type `text/x-markdown` or `text/markdown`), a convert button appears in the tiddler toolbar. Clicking it converts the markdown to wikitext.

!!! Action Widget

The `<$action-convert-markdown>` widget converts a markdown tiddler to wikitext format.

''Attributes:''

* `$tiddler` - Title of the tiddler to convert (defaults to current tiddler)

''Variables set for child widgets:''

* `success` - Set to `"yes"` if conversion succeeded, `"no"` if it failed
* `targetTiddler` - Title of the tiddler that was converted
* `errorMessage` - Error message if conversion failed (only set when `success="no"`)

''Example:''

```html
<$action-convert-markdown $tiddler="MyMarkdownTiddler">
  <$action-sendmessage 
    $message="tm-notify" 
    $param={{{ [<success>match[yes]then[ConvertSuccess]else[ConvertFailure]] }}}
  />
</$action-convert-markdown>
```

!!! Import Dialog

When importing tiddlers, check the "Convert Markdown files to WikiText on import" option to automatically convert all markdown tiddlers during import.

!! Dependencies

This module requires the `$:/plugins/tiddlywiki/markdown` plugin to be installed, as it uses the markdown-it library for parsing. Otherwise it will fail with a helpful error message.

!! Supported Markdown Features

* ''Headings'' - `# Heading` → `! Heading`
* ''Bold'' - `**bold**` → `''bold''`
* ''Italic'' - `*italic*` → `//italic//`
* ''Inline code'' - ` `code` ` → ` `code` `
* ''Code blocks'' - Fenced code blocks with language support
* ''Links'' - `[text](url)` → `[[text|url]]`
* ''Images'' - `![alt](src)` → `[img[alt|src]]`
* ''Lists'' - Both unordered (`*`) and ordered (`1.`) lists, including nested lists
* ''Blockquotes'' - `> quote` → `<<< quote >>>`
* ''Horizontal rules'' - `---` → `---`
* ''Paragraphs'' - Automatic paragraph handling
* ''Line breaks'' - Hard breaks (two spaces + newline)
* ''Strikethrough'' - `~~text~~` → `~~text~~`

!! Architecture

The conversion is implemented in a modular fashion:

* `mdast-to-wikiast.js` - Main conversion engine with public API
* `handlers/` - Individual handler modules for each markdown element type, for example:
** `heading.js` - MD Headings AST node to WikiText AST node

Each handler is a separate module with type `mdast-to-wikiast-rule`, making the system extensible.

!! Testing

Test cases are located in `editions/test/tiddlers/tests/data/markdown-to-wikitext/` and use the `text/vnd.tiddlywiki-multiple` format to specify:

* Input markdown (in the `Markdown` sub-tiddler)
* Expected wikitext output (in the `ExpectedWikitext` sub-tiddler)

Tests are tagged with `$:/tags/markdown-to-wikitext-test-spec` and run automatically as part of the test suite using the JavaScript API directly (not through a filter operator).
