"use strict";var e=require("$:/plugins/tiddlywiki/codemirror-6/lib/codemirror-state.js"),t=require("$:/plugins/tiddlywiki/codemirror-6/lib/codemirror-view.js"),o=require("$:/plugins/tiddlywiki/codemirror-6/lib/codemirror-language.js");class i{constructor(e,t,o,i){this.state=e,this.pos=t,this.explicit=o,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=o.syntaxTree(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),o=Math.max(t.from,this.pos-250),i=t.text.slice(o-t.from,this.pos-t.from),n=i.search(a(e,!1));return n<0?null:{from:o+n,to:this.pos,text:i.slice(n)}}get aborted(){return null==this.abortListeners}addEventListener(e,t,o){"abort"==e&&this.abortListeners&&(this.abortListeners.push(t),o&&o.onDocChange&&(this.abortOnDocChange=!0))}}function n(e){let t=Object.keys(e).join(""),o=/\w/.test(t);return o&&(t=t.replace(/\w/g,"")),`[${o?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function s(e){let t=e.map(e=>"string"==typeof e?{label:e}:e),[o,i]=t.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){let t=Object.create(null),o=Object.create(null);for(let{label:i}of e){t[i[0]]=!0;for(let e=1;e<i.length;e++)o[i[e]]=!0}let i=n(t)+n(o)+"*$";return[new RegExp("^"+i),new RegExp(i)]}(t);return e=>{let n=e.matchBefore(i);return n||e.explicit?{from:n?n.from:e.pos,options:t,validFor:o}:null}}class r{constructor(e,t,o,i){this.completion=e,this.source=t,this.match=o,this.score=i}}function l(e){return e.selection.main.from}function a(e,t){var o;let{source:i}=e,n=t&&"^"!=i[0],s="$"!=i[i.length-1];return n||s?new RegExp(`${n?"^":""}(?:${i})${s?"$":""}`,null!==(o=e.flags)&&void 0!==o?o:e.ignoreCase?"i":""):e}const c=e.Annotation.define();function p(t,o,i,n){let{main:s}=t.selection,r=i-s.from,l=n-s.from;return{...t.changeByRange(a=>{if(a!=s&&i!=n&&t.sliceDoc(a.from+r,a.from+l)!=t.sliceDoc(i,n))return{range:a};let c=t.toText(o);return{changes:{from:a.from+r,to:n==s.from?a.to:a.from+l,insert:c},range:e.EditorSelection.cursor(a.from+r+c.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const h=new WeakMap;function d(e){if(!Array.isArray(e))return e;let t=h.get(e);return t||h.set(e,t=s(e)),t}const f=e.StateEffect.define(),u=e.StateEffect.define();class m{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let o=0;o<t.length;){let i=e.codePointAt(t,o),n=e.codePointSize(i);this.chars.push(i);let s=t.slice(o,o+n),r=s.toUpperCase();this.folded.push(e.codePointAt(r==s?s.toLowerCase():r,0)),o+=n}this.astral=t.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(t){if(0==this.pattern.length)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:o,folded:i,any:n,precise:s,byWord:r}=this;if(1==o.length){let n=e.codePointAt(t,0),s=e.codePointSize(n),r=s==t.length?0:-100;if(n==o[0]);else{if(n!=i[0])return null;r+=-200}return this.ret(r,[0,s])}let l=t.indexOf(this.pattern);if(0==l)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=o.length,c=0;if(l<0){for(let s=0,r=Math.min(t.length,200);s<r&&c<a;){let r=e.codePointAt(t,s);r!=o[c]&&r!=i[c]||(n[c++]=s),s+=e.codePointSize(r)}if(c<a)return null}let p=0,h=0,d=!1,f=0,u=-1,m=-1,g=/[a-z]/.test(t),v=!0;for(let n=0,c=Math.min(t.length,200),b=0;n<c&&h<a;){let c=e.codePointAt(t,n);l<0&&(p<a&&c==o[p]&&(s[p++]=n),f<a&&(c==o[f]||c==i[f]?(0==f&&(u=n),m=n+1,f++):f=0));let x,y=c<255?c>=48&&c<=57||c>=97&&c<=122?2:c>=65&&c<=90?1:0:(x=e.fromCodePoint(c))!=x.toLowerCase()?1:x!=x.toUpperCase()?2:0;(!n||1==y&&g||0==b&&0!=y)&&(o[h]==c||i[h]==c&&(d=!0)?r[h++]=n:r.length&&(v=!1)),b=y,n+=e.codePointSize(c)}return h==a&&0==r[0]&&v?this.result((d?-200:0)-100,r,t):f==a&&0==u?this.ret(-200-t.length+(m==t.length?0:-100),[0,m]):l>-1?this.ret(-700-t.length,[l,l+this.pattern.length]):f==a?this.ret(-900-t.length,[u,m]):h==a?this.result((d?-200:0)-100-700+(v?0:-1100),r,t):2==o.length?null:this.result((n[0]?-700:0)-200-1100,n,t)}result(t,o,i){let n=[],s=0;for(let t of o){let o=t+(this.astral?e.codePointSize(e.codePointAt(i,t)):1);s&&n[s-1]==t?n[s-1]=o:(n[s++]=t,n[s++]=o)}return this.ret(t-i.length,n)}}class g{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),o=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return null==o?null:(this.matched=[0,t.length],this.score=o+(e.length==this.pattern.length?0:-100),this)}}const v=e.Facet.define({combine:t=>e.combineConfig(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:x,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>o=>b(e(o),t(o)),optionClass:(e,t)=>o=>b(e(o),t(o)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})});function b(e,t){return e?t?e+" "+t:e:t}function x(e,o,i,n,s,r){let l,a,c=e.textDirection==t.Direction.RTL,p=c,h=!1,d="top",f=o.left-s.left,u=s.right-o.right,m=n.right-n.left,g=n.bottom-n.top;if(p&&f<Math.min(m,u)?p=!1:!p&&u<Math.min(m,f)&&(p=!0),m<=(p?f:u))l=Math.max(s.top,Math.min(i.top,s.bottom-g))-o.top,a=Math.min(400,p?f:u);else{h=!0,a=Math.min(400,(c?o.right:s.right-o.left)-30);let e=s.bottom-o.bottom;e>=g||e>o.top?l=i.bottom-o.top:(d="bottom",l=o.bottom-i.top)}return{style:`${d}: ${l/((o.bottom-o.top)/r.offsetHeight)}px; max-width: ${a/((o.right-o.left)/r.offsetWidth)}px`,class:"cm-completionInfo-"+(h?c?"left-narrow":"right-narrow":p?"left":"right")}}function y(e,t,o){if(e<=o)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/o);return{from:e*o,to:(e+1)*o}}let i=Math.floor((e-t)/o);return{from:e-(i+1)*o,to:e-i*o}}class w{constructor(e,t,o){this.view=e,this.stateField=t,this.applyCompletion=o,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:n,selected:s}=i.open,r=e.state.facet(v);this.optionContent=function(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,o,i){let n=document.createElement("span");n.className="cm-completionLabel";let s=e.displayLabel||e.label,r=0;for(let e=0;e<i.length;){let t=i[e++],o=i[e++];t>r&&n.appendChild(document.createTextNode(s.slice(r,t)));let l=n.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(s.slice(t,o))),l.className="cm-completionMatchedText",r=o}return r<s.length&&n.appendChild(document.createTextNode(s.slice(r))),n},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort((e,t)=>e.position-t.position).map(e=>e.render)}(r),this.optionClass=r.optionClass,this.tooltipClass=r.tooltipClass,this.range=y(n.length,s,r.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",o=>{let{options:i}=e.state.field(t).open;for(let t,n=o.target;n&&n!=this.dom;n=n.parentNode)if("LI"==n.nodeName&&(t=/-(\d+)$/.exec(n.id))&&+t[1]<i.length)return this.applyCompletion(e,i[+t[1]]),void o.preventDefault()}),this.dom.addEventListener("focusout",t=>{let o=e.state.field(this.stateField,!1);o&&o.tooltip&&e.state.facet(v).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:u.of(null)})}),this.showOptions(n,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let o=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),o!=i){let{options:n,selected:s,disabled:r}=o.open;i.open&&i.open.options==n||(this.range=y(n.length,s,e.state.facet(v).maxRenderedOptions),this.showOptions(n,o.id)),this.updateSel(),r!=(null===(t=i.open)||void 0===t?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!r)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),o=e.open;(o.selected>-1&&o.selected<this.range.from||o.selected>=this.range.to)&&(this.range=y(o.options.length,o.selected,this.view.state.facet(v).maxRenderedOptions),this.showOptions(o.options,e.id));let i=this.updateSelectedOption(o.selected);if(i){this.destroyInfo();let{completion:n}=o.options[o.selected],{info:s}=n;if(!s)return;let r="string"==typeof s?document.createTextNode(s):s(n);if(!r)return;"then"in r?r.then(t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)}).catch(e=>t.logException(this.view.state,e,"completion info")):(this.addInfoPane(r,n),i.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let o=this.info=document.createElement("div");if(o.className="cm-tooltip cm-completionInfo",o.id="cm-completionInfo-"+Math.floor(65535*Math.random()).toString(16),null!=e.nodeType)o.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:i}=e;o.appendChild(t),this.infoDestroy=i||null}this.dom.appendChild(o),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let o=this.list.firstChild,i=this.range.from;o;o=o.nextSibling,i++)"LI"==o.nodeName&&o.id?i==e?o.hasAttribute("aria-selected")||(o.setAttribute("aria-selected","true"),t=o):o.hasAttribute("aria-selected")&&(o.removeAttribute("aria-selected"),o.removeAttribute("aria-describedby")):i--;return t&&function(e,t){let o=e.getBoundingClientRect(),i=t.getBoundingClientRect(),n=o.height/e.offsetHeight;i.top<o.top?e.scrollTop-=(o.top-i.top)/n:i.bottom>o.bottom&&(e.scrollTop+=(i.bottom-o.bottom)/n)}(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),o=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),n=this.space;if(!n){let e=this.dom.ownerDocument.documentElement;n={left:0,top:0,right:e.clientWidth,bottom:e.clientHeight}}return i.top>Math.min(n.bottom,t.bottom)-10||i.bottom<Math.max(n.top,t.top)+10?null:this.view.state.facet(v).positionInfo(this.view,t,i,o,n,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,o){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",e=>{e.target==i&&e.preventDefault()});let n=null;for(let s=o.from;s<o.to;s++){let{completion:r,match:l}=e[s],{section:a}=r;if(a){let e="string"==typeof a?a:a.name;if(e!=n&&(s>o.from||0==o.from))if(n=e,"string"!=typeof a&&a.header)i.appendChild(a.header(a));else{i.appendChild(document.createElement("completion-section")).textContent=e}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+s,c.setAttribute("role","option");let p=this.optionClass(r);p&&(c.className=p);for(let e of this.optionContent){let t=e(r,this.view.state,this.view,l);t&&c.appendChild(t)}}return o.from&&i.classList.add("cm-completionListIncompleteTop"),o.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function C(e,t){return o=>new w(o,e,t)}function S(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}class I{constructor(e,t,o,i,n,s){this.options=e,this.attrs=t,this.tooltip=o,this.timestamp=i,this.selected=n,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new I(this.options,T(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,o,i,n,s){if(i&&!s&&e.some(e=>e.isPending))return i.setDisabled();let l=function(e,t){let o=[],i=null,n=null,s=e=>{o.push(e);let{section:t}=e.completion;if(t){i||(i=[]);let e="string"==typeof t?t:t.name;i.some(t=>t.name==e)||i.push("string"==typeof t?{name:e}:t)}},l=t.facet(v);for(let i of e)if(i.hasResult()){let e=i.result.getMatch;if(!1===i.result.filter)for(let t of i.result.options)s(new r(t,i.source,e?e(t):[],1e9-o.length));else{let o,a=t.sliceDoc(i.from,i.to),c=l.filterStrict?new g(a):new m(a);for(let t of i.result.options)if(o=c.match(t.label)){let l=t.displayLabel?e?e(t,o.matched):[]:o.matched,a=o.score+(t.boost||0);if(s(new r(t,i.source,l,a)),"object"==typeof t.section&&"dynamic"===t.section.rank){let{name:e}=t.section;n||(n=Object.create(null)),n[e]=Math.max(a,n[e]||-1e9)}}}}if(i){let e=Object.create(null),t=0,s=(e,t)=>("dynamic"===e.rank&&"dynamic"===t.rank?n[t.name]-n[e.name]:0)||("number"==typeof e.rank?e.rank:1e9)-("number"==typeof t.rank?t.rank:1e9)||(e.name<t.name?-1:1);for(let o of i.sort(s))t-=1e5,e[o.name]=t;for(let t of o){let{section:o}=t.completion;o&&(t.score+=e["string"==typeof o?o:o.name])}}let a=[],c=null,p=l.compareCompletions;for(let e of o.sort((e,t)=>t.score-e.score||p(e.completion,t.completion))){let t=e.completion;!c||c.label!=t.label||c.detail!=t.detail||null!=c.type&&null!=t.type&&c.type!=t.type||c.apply!=t.apply||c.boost!=t.boost?a.push(e):S(e.completion)>S(c)&&(a[a.length-1]=e),c=e.completion}return a}(e,t);if(!l.length)return i&&e.some(e=>e.isPending)?i.setDisabled():null;let a=t.facet(v).selectOnOpen?0:-1;if(i&&i.selected!=a&&-1!=i.selected){let e=i.options[i.selected].completion;for(let t=0;t<l.length;t++)if(l[t].completion==e){a=t;break}}return new I(l,T(o,a),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:$,above:n.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new I(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new I(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class k{constructor(e,t,o){this.active=e,this.id=t,this.open=o}static start(){return new k(A,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,o=t.facet(v),i=(o.override||t.languageDataAt("autocomplete",l(t)).map(d)).map(t=>(this.active.find(e=>e.source==t)||new O(t,this.active.some(e=>0!=e.state)?1:0)).update(e,o));i.length==this.active.length&&i.every((e,t)=>e==this.active[t])&&(i=this.active);let n=this.open,s=e.effects.some(e=>e.is(R));n&&e.docChanged&&(n=n.map(e.changes)),e.selection||i.some(t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to))||!function(e,t){if(e==t)return!0;for(let o=0,i=0;;){for(;o<e.length&&!e[o].hasResult();)o++;for(;i<t.length&&!t[i].hasResult();)i++;let n=o==e.length,s=i==t.length;if(n||s)return n==s;if(e[o++].result!=t[i++].result)return!1}}(i,this.active)||s?n=I.build(i,t,this.id,n,o,s):n&&n.disabled&&!i.some(e=>e.isPending)&&(n=null),!n&&i.every(e=>!e.isPending)&&i.some(e=>e.hasResult())&&(i=i.map(e=>e.hasResult()?new O(e.source,0):e));for(let t of e.effects)t.is(L)&&(n=n&&n.setSelected(t.value,this.id));return i==this.active&&n==this.open?this:new k(i,this.id,n)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?E:P}}const E={"aria-autocomplete":"list"},P={};function T(e,t){let o={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(o["aria-activedescendant"]=e+"-"+t),o}const A=[];function D(e,t){if(e.isUserEvent("input.complete")){let o=e.annotation(c);if(o&&t.activateOnCompletion(o))return 12}let o=e.isUserEvent("input.type");return o&&t.activateOnTyping?5:o?1:e.isUserEvent("delete.backward")?2:e.selection?8:e.docChanged?16:0}class O{constructor(e,t,o=!1){this.source=e,this.state=t,this.explicit=o}hasResult(){return!1}get isPending(){return 1==this.state}update(e,t){let o=D(e,t),i=this;(8&o||16&o&&this.touches(e))&&(i=new O(i.source,0)),4&o&&0==i.state&&(i=new O(this.source,1)),i=i.updateFor(e,o);for(let t of e.effects)if(t.is(f))i=new O(i.source,1,t.value);else if(t.is(u))i=new O(i.source,0);else if(t.is(R))for(let e of t.value)e.source==i.source&&(i=e);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(l(e.state))}}class M extends O{constructor(e,t,o,i,n,s){super(e,3,t),this.limit=o,this.result=i,this.from=n,this.to=s}hasResult(){return!0}updateFor(e,t){var o;if(!(3&t))return this.map(e.changes);let n=this.result;n.map&&!e.changes.empty&&(n=n.map(n,e.changes));let s=e.changes.mapPos(this.from),r=e.changes.mapPos(this.to,1),c=l(e.state);if(c>r||!n||2&t&&(l(e.startState)==this.from||c<this.limit))return new O(this.source,4&t?1:0);let p=e.changes.mapPos(this.limit);return function(e,t,o,i){if(!e)return!1;let n=t.sliceDoc(o,i);return"function"==typeof e?e(n,o,i,t):a(e,!0).test(n)}(n.validFor,e.state,s,r)?new M(this.source,this.explicit,p,n,s,r):n.update&&(n=n.update(n,s,r,new i(e.state,c,!1)))?new M(this.source,this.explicit,p,n,n.from,null!==(o=n.to)&&void 0!==o?o:l(e.state)):new O(this.source,1,this.explicit)}map(e){if(e.empty)return this;return(this.result.map?this.result.map(this.result,e):this.result)?new M(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new O(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}const R=e.StateEffect.define({map:(e,t)=>e.map(e=>e.map(t))}),L=e.StateEffect.define(),F=e.StateField.define({create:()=>k.start(),update:(e,t)=>e.update(t),provide:e=>[t.showTooltip.from(e,e=>e.tooltip),t.EditorView.contentAttributes.from(e,e=>e.attrs)]});function B(e,t){const o=t.completion.apply||t.completion.label;let i=e.state.field(F).active.find(e=>e.source==t.source);return i instanceof M&&("string"==typeof o?e.dispatch({...p(e.state,o,i.from,i.to),annotations:c.of(t.completion)}):o(e,t.completion,i.from,i.to),!0)}const $=C(F,B);function N(e,o="option"){return i=>{let n=i.state.field(F,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(v).interactionDelay)return!1;let s,r=1;"page"==o&&(s=t.getTooltip(i,n.open.tooltip))&&(r=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:l}=n.open.options,a=n.open.selected>-1?n.open.selected+r*(e?1:-1):e?0:l-1;return a<0?a="page"==o?0:l-1:a>=l&&(a="page"==o?l-1:0),i.dispatch({effects:L.of(a)}),!0}}const W=e=>{let t=e.state.field(F,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(v).interactionDelay)&&B(e,t.open.options[t.open.selected])},q=e=>!!e.state.field(F,!1)&&(e.dispatch({effects:f.of(!0)}),!0),U=e=>{let t=e.state.field(F,!1);return!(!t||!t.active.some(e=>0!=e.state))&&(e.dispatch({effects:u.of(null)}),!0)};class V{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const j=t.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of e.state.field(F).active)t.isPending&&this.startQuery(t)}update(e){let o=e.state.field(F),i=e.state.facet(v);if(!e.selectionSet&&!e.docChanged&&e.startState.field(F)==o)return;let n=e.transactions.some(e=>{let t=D(e,i);return 8&t||(e.selection||e.docChanged)&&!(3&t)});for(let o=0;o<this.running.length;o++){let i=this.running[o];if(n||i.context.abortOnDocChange&&e.docChanged||i.updates.length+e.transactions.length>50&&Date.now()-i.time>1e3){for(let e of i.context.abortListeners)try{e()}catch(e){t.logException(this.view.state,e)}i.context.abortListeners=null,this.running.splice(o--,1)}else i.updates.push(...e.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),e.transactions.some(e=>e.effects.some(e=>e.is(f)))&&(this.pendingStart=!0);let s=this.pendingStart?50:i.activateOnTypingDelay;if(this.debounceUpdate=o.active.some(e=>e.isPending&&!this.running.some(t=>t.active.source==e.source))?setTimeout(()=>this.startUpdate(),s):-1,0!=this.composing)for(let t of e.transactions)t.isUserEvent("input.type")?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:e}=this.view,t=e.field(F);for(let e of t.active)e.isPending&&!this.running.some(t=>t.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(v).updateSyncTime))}startQuery(e){let{state:o}=this.view,n=l(o),s=new i(o,n,e.explicit,this.view),r=new V(e,s);this.running.push(r),Promise.resolve(e.source(s)).then(e=>{r.context.aborted||(r.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:u.of(null)}),t.logException(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(v).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],o=this.view.state.facet(v),i=this.view.state.field(F);for(let n=0;n<this.running.length;n++){let s=this.running[n];if(void 0===s.done)continue;if(this.running.splice(n--,1),s.done){let i=l(s.updates.length?s.updates[0].startState:this.view.state),n=Math.min(i,s.done.from+(s.active.explicit?0:1)),r=new M(s.active.source,s.active.explicit,n,s.done,s.done.from,null!==(e=s.done.to)&&void 0!==e?e:i);for(let e of s.updates)r=r.update(e,o);if(r.hasResult()){t.push(r);continue}}let r=i.active.find(e=>e.source==s.active.source);if(r&&r.isPending)if(null==s.done){let e=new O(s.active.source,0);for(let t of s.updates)e=e.update(t,o);e.isPending||t.push(e)}else this.startQuery(r)}(t.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:R.of(t)})}},{eventHandlers:{blur(e){let o=this.view.state.field(F,!1);if(o&&o.tooltip&&this.view.state.facet(v).closeOnBlur){let i=o.open&&t.getTooltip(this.view,o.open.tooltip);i&&i.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:u.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:f.of(!1)}),20),this.composing=0}}}),z="object"==typeof navigator&&/Win/.test(navigator.platform),H=e.Prec.highest(t.EditorView.domEventHandlers({keydown(e,t){let o=t.state.field(F,!1);if(!o||!o.open||o.open.disabled||o.open.selected<0||e.key.length>1||e.ctrlKey&&(!z||!e.altKey)||e.metaKey)return!1;let i=o.open.options[o.open.selected],n=o.active.find(e=>e.source==i.source),s=i.completion.commitCharacters||n.result.commitCharacters;return s&&s.indexOf(e.key)>-1&&B(t,i),!1}})),K=t.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"¬∑¬∑¬∑"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'∆í'"}},".cm-completionIcon-class":{"&:after":{content:"'‚óã'"}},".cm-completionIcon-interface":{"&:after":{content:"'‚óå'"}},".cm-completionIcon-variable":{"&:after":{content:"'ùë•'"}},".cm-completionIcon-constant":{"&:after":{content:"'ùê∂'"}},".cm-completionIcon-type":{"&:after":{content:"'ùë°'"}},".cm-completionIcon-enum":{"&:after":{content:"'‚à™'"}},".cm-completionIcon-property":{"&:after":{content:"'‚ñ°'"}},".cm-completionIcon-keyword":{"&:after":{content:"'üîëÔ∏é'"}},".cm-completionIcon-namespace":{"&:after":{content:"'‚ñ¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Q{constructor(e,t,o,i){this.field=e,this.line=t,this.from=o,this.to=i}}class X{constructor(e,t,o){this.field=e,this.from=t,this.to=o}map(t){let o=t.mapPos(this.from,-1,e.MapMode.TrackDel),i=t.mapPos(this.to,1,e.MapMode.TrackDel);return null==o||null==i?null:new X(this.field,o,i)}}class _{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],n=[t],s=e.doc.lineAt(t),r=/^\s*/.exec(s.text)[0];for(let s of this.lines){if(i.length){let i=r,l=/^\t*/.exec(s)[0].length;for(let t=0;t<l;t++)i+=e.facet(o.indentUnit);n.push(t+i.length-l),s=i+s.slice(l)}i.push(s),t+=s.length+1}let l=this.fieldPositions.map(e=>new X(e.field,n[e.line]+e.from,n[e.line]+e.to));return{text:i,ranges:l}}static parse(e){let t,o=[],i=[],n=[];for(let s of e.split(/\r\n?|\n/)){for(;t=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(s);){let e=t[1]?+t[1]:null,r=t[2]||t[3]||"",l=-1,a=r.replace(/\\[{}]/g,e=>e[1]);for(let t=0;t<o.length;t++)(null!=e?o[t].seq==e:a&&o[t].name==a)&&(l=t);if(l<0){let t=0;for(;t<o.length&&(null==e||null!=o[t].seq&&o[t].seq<e);)t++;o.splice(t,0,{seq:e,name:a}),l=t;for(let e of n)e.field>=l&&e.field++}for(let e of n)if(e.line==i.length&&e.from>t.index){let o=t[2]?3+(t[1]||"").length:2;e.from-=o,e.to-=o}n.push(new Q(l,i.length,t.index,t.index+a.length)),s=s.slice(0,t.index)+r+s.slice(t.index+t[0].length)}s=s.replace(/\\([{}])/g,(e,t,o)=>{for(let e of n)e.line==i.length&&e.from>o&&(e.from--,e.to--);return t}),i.push(s)}return new _(i,n)}}let Y=t.Decoration.widget({widget:new class extends t.WidgetType{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),G=t.Decoration.mark({class:"cm-snippetField"});class J{constructor(e,o){this.ranges=e,this.active=o,this.deco=t.Decoration.set(e.map(e=>(e.from==e.to?Y:G).range(e.from,e.to)),!0)}map(e){let t=[];for(let o of this.ranges){let i=o.map(e);if(!i)return null;t.push(i)}return new J(t,this.active)}selectionInsideField(e){return e.ranges.every(e=>this.ranges.some(t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))}}const Z=e.StateEffect.define({map:(e,t)=>e&&e.map(t)}),ee=e.StateEffect.define(),te=e.StateField.define({create:()=>null,update(e,t){for(let o of t.effects){if(o.is(Z))return o.value;if(o.is(ee)&&e)return new J(e.ranges,o.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>t.EditorView.decorations.from(e,e=>e?e.deco:t.Decoration.none)});function oe(t,o){return e.EditorSelection.create(t.filter(e=>e.field==o).map(t=>e.EditorSelection.range(t.from,t.to)))}function ie(t){let o=_.parse(t);return(t,i,n,s)=>{let{text:r,ranges:l}=o.instantiate(t.state,n),{main:a}=t.state.selection,p={changes:{from:n,to:s==a.from?a.to:s,insert:e.Text.of(r)},scrollIntoView:!0,annotations:i?[c.of(i),e.Transaction.userEvent.of("input.complete")]:void 0};if(l.length&&(p.selection=oe(l,0)),l.some(e=>e.field>0)){let o=new J(l,0),i=p.effects=[Z.of(o)];void 0===t.state.field(te,!1)&&i.push(e.StateEffect.appendConfig.of([te,pe,he,K]))}t.dispatch(t.state.update(p))}}function ne(e){return({state:t,dispatch:o})=>{let i=t.field(te,!1);if(!i||e<0&&0==i.active)return!1;let n=i.active+e,s=e>0&&!i.ranges.some(t=>t.field==n+e);return o(t.update({selection:oe(i.ranges,n),effects:Z.of(s?null:new J(i.ranges,n)),scrollIntoView:!0})),!0}}const se=({state:e,dispatch:t})=>!!e.field(te,!1)&&(t(e.update({effects:Z.of(null)})),!0),re=ne(1),le=ne(-1);const ae=[{key:"Tab",run:re,shift:le},{key:"Escape",run:se}],ce=e.Facet.define({combine:e=>e.length?e[0]:ae}),pe=e.Prec.highest(t.keymap.compute([ce],e=>e.facet(ce)));const he=t.EditorView.domEventHandlers({mousedown(e,t){let o,i=t.state.field(te,!1);if(!i||null==(o=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let n=i.ranges.find(e=>e.from<=o&&e.to>=o);return!(!n||n.field==i.active)&&(t.dispatch({selection:oe(i.ranges,n.field),effects:Z.of(i.ranges.some(e=>e.field>n.field)?new J(i.ranges,n.field):null),scrollIntoView:!0}),!0)}});function de(e,t){return new RegExp(t(e.source),e.unicode?"u":"")}const fe=Object.create(null);function ue(e,t,o,i,n){for(let s=e.iterLines(),r=0;!s.next().done;){let e,{value:l}=s;for(t.lastIndex=0;e=t.exec(l);)if(!i[e[0]]&&r+e.index!=n&&(o.push({type:"text",label:e[0]}),i[e[0]]=!0,o.length>=2e3))return;r+=l.length+1}}function me(e,t,o,i,n){let s=e.length>=1e3,r=s&&t.get(e);if(r)return r;let l=[],a=Object.create(null);if(e.children){let s=0;for(let r of e.children){if(r.length>=1e3)for(let e of me(r,t,o,i-s,n-s))a[e.label]||(a[e.label]=!0,l.push(e));else ue(r,o,l,a,n-s);s+=r.length+1}}else ue(e,o,l,a,n);return s&&l.length<2e3&&t.set(e,l),l}const ge={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},ve=e.StateEffect.define({map(t,o){let i=o.mapPos(t,-1,e.MapMode.TrackAfter);return null==i?void 0:i}}),be=new class extends e.RangeValue{};be.startSide=1,be.endSide=-1;const xe=e.StateField.define({create:()=>e.RangeSet.empty,update(e,t){if(e=e.map(t.changes),t.selection){let o=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=o.from&&e<=o.to})}for(let o of t.effects)o.is(ve)&&(e=e.update({add:[be.range(o.value,o.value+1)]}));return e}});const ye="()[]{}<>¬´¬ª¬ª¬´ÔºªÔºΩÔΩõÔΩù";function we(t){for(let e=0;e<16;e+=2)if(ye.charCodeAt(e)==t)return ye.charAt(e+1);return e.fromCodePoint(t<128?t:t+1)}function Ce(e,t){return e.languageDataAt("closeBrackets",t)[0]||ge}const Se="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Ie=t.EditorView.inputHandler.of((t,o,i,n)=>{if((Se?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let s=t.state.selection.main;if(n.length>2||2==n.length&&1==e.codePointSize(e.codePointAt(n,0))||o!=s.from||i!=s.to)return!1;let r=Pe(t.state,n);return!!r&&(t.dispatch(r),!0)}),ke=({state:t,dispatch:o})=>{if(t.readOnly)return!1;let i=Ce(t,t.selection.main.head).brackets||ge.brackets,n=null,s=t.changeByRange(o=>{if(o.empty){let n=function(t,o){let i=t.sliceString(o-2,o);return e.codePointSize(e.codePointAt(i,0))==i.length?i:i.slice(1)}(t.doc,o.head);for(let s of i)if(s==n&&Ae(t.doc,o.head)==we(e.codePointAt(s,0)))return{changes:{from:o.head-s.length,to:o.head+s.length},range:e.EditorSelection.cursor(o.head-s.length)}}return{range:n=o}});return n||o(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},Ee=[{key:"Backspace",run:ke}];function Pe(t,o){let i=Ce(t,t.selection.main.head),n=i.brackets||ge.brackets;for(let s of n){let r=we(e.codePointAt(s,0));if(o==s)return r==s?Me(t,s,n.indexOf(s+s+s)>-1,i):De(t,s,r,i.before||ge.before);if(o==r&&Te(t,t.selection.main.from))return Oe(t,s,r)}return null}function Te(e,t){let o=!1;return e.field(xe).between(0,e.doc.length,e=>{e==t&&(o=!0)}),o}function Ae(t,o){let i=t.sliceString(o,o+2);return i.slice(0,e.codePointSize(e.codePointAt(i,0)))}function De(t,o,i,n){let s=null,r=t.changeByRange(r=>{if(!r.empty)return{changes:[{insert:o,from:r.from},{insert:i,from:r.to}],effects:ve.of(r.to+o.length),range:e.EditorSelection.range(r.anchor+o.length,r.head+o.length)};let l=Ae(t.doc,r.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:o+i,from:r.head},effects:ve.of(r.head+o.length),range:e.EditorSelection.cursor(r.head+o.length)}:{range:s=r}});return s?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Oe(t,o,i){let n=null,s=t.changeByRange(o=>o.empty&&Ae(t.doc,o.head)==i?{changes:{from:o.head,to:o.head+i.length,insert:i},range:e.EditorSelection.cursor(o.head+i.length)}:n={range:o});return n?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Me(t,i,n,s){let r=s.stringPrefixes||ge.stringPrefixes,l=null,a=t.changeByRange(s=>{if(!s.empty)return{changes:[{insert:i,from:s.from},{insert:i,from:s.to}],effects:ve.of(s.to+i.length),range:e.EditorSelection.range(s.anchor+i.length,s.head+i.length)};let a,c=s.head,p=Ae(t.doc,c);if(p==i){if(Re(t,c))return{changes:{insert:i+i,from:c},effects:ve.of(c+i.length),range:e.EditorSelection.cursor(c+i.length)};if(Te(t,c)){let o=n&&t.sliceDoc(c,c+3*i.length)==i+i+i?i+i+i:i;return{changes:{from:c,to:c+o.length,insert:o},range:e.EditorSelection.cursor(c+o.length)}}}else{if(n&&t.sliceDoc(c-2*i.length,c)==i+i&&(a=Le(t,c-2*i.length,r))>-1&&Re(t,a))return{changes:{insert:i+i+i+i,from:c},effects:ve.of(c+i.length),range:e.EditorSelection.cursor(c+i.length)};if(t.charCategorizer(c)(p)!=e.CharCategory.Word&&Le(t,c,r)>-1&&!function(e,t,i,n){let s=o.syntaxTree(e).resolveInner(t,-1),r=n.reduce((e,t)=>Math.max(e,t.length),0);for(let o=0;o<5;o++){let o=e.sliceDoc(s.from,Math.min(s.to,s.from+i.length+r)),l=o.indexOf(i);if(!l||l>-1&&n.indexOf(o.slice(0,l))>-1){let t=s.firstChild;for(;t&&t.from==s.from&&t.to-t.from>i.length+l;){if(e.sliceDoc(t.to-i.length,t.to)==i)return!1;t=t.firstChild}return!0}let a=s.to==t&&s.parent;if(!a)break;s=a}return!1}(t,c,i,r))return{changes:{insert:i+i,from:c},effects:ve.of(c+i.length),range:e.EditorSelection.cursor(c+i.length)}}return{range:l=s}});return l?null:t.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function Re(e,t){let i=o.syntaxTree(e).resolveInner(t+1);return i.parent&&i.from==t}function Le(t,o,i){let n=t.charCategorizer(o);if(n(t.sliceDoc(o-1,o))!=e.CharCategory.Word)return o;for(let s of i){let i=o-s.length;if(t.sliceDoc(i,o)==s&&n(t.sliceDoc(i-1,i))!=e.CharCategory.Word)return i}return-1}const Fe=[{key:"Ctrl-Space",run:q},{mac:"Alt-`",run:q},{mac:"Alt-i",run:q},{key:"Escape",run:U},{key:"ArrowDown",run:N(!0)},{key:"ArrowUp",run:N(!1)},{key:"PageDown",run:N(!0,"page")},{key:"PageUp",run:N(!1,"page")},{key:"Enter",run:W}],Be=e.Prec.highest(t.keymap.computeN([v],e=>e.facet(v).defaultKeymap?[Fe]:[]));const $e=new WeakMap;exports.CompletionContext=i,exports.acceptCompletion=W,exports.autocompletion=function(e={}){return[H,F,v.of(e),j,Be,K]},exports.clearSnippet=se,exports.closeBrackets=function(){return[Ie,xe]},exports.closeBracketsKeymap=Ee,exports.closeCompletion=U,exports.completeAnyWord=e=>{let t=e.state.languageDataAt("wordChars",e.pos).join(""),o=function(e){let t=e.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${t}]+`,"ug")}catch(e){return new RegExp(`[w${t}]`,"g")}}(t),i=e.matchBefore(de(o,e=>e+"$"));if(!i&&!e.explicit)return null;let n=i?i.from:e.pos,s=me(e.state.doc,function(e){return fe[e]||(fe[e]=new WeakMap)}(t),o,5e4,n);return{from:n,options:s,validFor:de(o,e=>"^"+e)}},exports.completeFromList=s,exports.completionKeymap=Fe,exports.completionStatus=function(e){let t=e.field(F,!1);return t&&t.active.some(e=>e.isPending)?"pending":t&&t.active.some(e=>0!=e.state)?"active":null},exports.currentCompletions=function(e){var t;let o=null===(t=e.field(F,!1))||void 0===t?void 0:t.open;if(!o||o.disabled)return[];let i=$e.get(o.options);return i||$e.set(o.options,i=o.options.map(e=>e.completion)),i},exports.deleteBracketPair=ke,exports.hasNextSnippetField=function(e){let t=e.field(te,!1);return!(!t||!t.ranges.some(e=>e.field==t.active+1))},exports.hasPrevSnippetField=function(e){let t=e.field(te,!1);return!!(t&&t.active>0)},exports.ifIn=function(e,t){return i=>{for(let n=o.syntaxTree(i.state).resolveInner(i.pos,-1);n;n=n.parent){if(e.indexOf(n.name)>-1)return t(i);if(n.type.isTop)break}return null}},exports.ifNotIn=function(e,t){return i=>{for(let t=o.syntaxTree(i.state).resolveInner(i.pos,-1);t;t=t.parent){if(e.indexOf(t.name)>-1)return null;if(t.type.isTop)break}return t(i)}},exports.insertBracket=Pe,exports.insertCompletionText=p,exports.moveCompletionSelection=N,exports.nextSnippetField=re,exports.pickedCompletion=c,exports.prevSnippetField=le,exports.selectedCompletion=function(e){var t;let o=null===(t=e.field(F,!1))||void 0===t?void 0:t.open;return o&&!o.disabled&&o.selected>=0?o.options[o.selected].completion:null},exports.selectedCompletionIndex=function(e){var t;let o=null===(t=e.field(F,!1))||void 0===t?void 0:t.open;return o&&!o.disabled&&o.selected>=0?o.selected:null},exports.setSelectedCompletion=function(e){return L.of(e)},exports.snippet=ie,exports.snippetCompletion=function(e,t){return{...t,apply:ie(e)}},exports.snippetKeymap=ce,exports.startCompletion=q;
